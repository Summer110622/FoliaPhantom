### Core Enhancements & Passenger Management

This pull request introduces significant enhancements to the Folia Phantom compatibility layer,
focusing on expanding the surface area of thread-safe API redirections.
The core of this update is the implementation of new execution wrappers in FoliaPatcher,
specifically targeting entity interaction patterns that are commonly used in legacy Bukkit plugins
 but require strict regional synchronization in Folia.

One of the primary additions is the support for Passenger management. In Folia, adding or removing
passengers must be executed on the entity's own scheduler to ensure that both the vehicle and the
passenger are correctly synchronized within the same tick and region.
We have added `_ap` (addPassenger), `_rp` (removePassenger), and `_ej` (eject) helpers.
These helpers automatically detect if the call is already on the primary thread and, if not,
they delegate the operation to the entity's scheduler.
This prevents the dreaded 'Entity is being ticked in a different region' exceptions
that often occur when plugins attempt to modify entity relationships from asynchronous tasks
or event handlers running in different regions.

Furthermore, we've updated the ThreadSafetyTransformer to recognize these method signatures.
The transformer now performs a stack-aware injection of the Plugin instance,
ensures the original arguments are preserved in local variables,
and redirects the INVOKEINTERFACE calls to our static FoliaPatcher methods.
This process is completely transparent to the plugin developer,
allowing existing JARs to run on Folia without source code modifications.











































































### Spatial Queries & Potion Effects

In addition to passenger management, we have addressed the need for thread-safe entity discovery.
The `Entity#getNearbyEntities(double, double, double)` method is frequently used by combat and
utility plugins to find targets or nearby players. In a multi-threaded region environment like Folia,
querying entities in a 3D space is an operation that must be performed within the context of the
region where the searching entity resides.

We have implemented the `_ne` (getNearbyEntities) wrapper, which safely encapsulates this query.
If called from a non-primary thread, it uses the entity's scheduler to run the search and
returns the result through a CompletableFuture, maintaining the expected return type of
`java.util.List<Entity>`. This ensures that plugins can continue to use spatial queries
without triggering concurrency issues or accessing inconsistent world states.

We also introduced thread-safe Potion Effect management via `_ae` (addPotionEffect) and
`_re` (removePotionEffect). Modifying an entity's active potion effects involves updating
the entity's metadata and scheduling client-side synchronization packets, both of which
are thread-sensitive operations in Folia. By wrapping these in the entity's scheduler,
we guarantee that the state changes are applied correctly and that no race conditions
occur when multiple plugins or the server itself attempt to modify effects simultaneously.
The inclusion of the FIRE_AND_FORGET optimization flag allows these operations to be
executed without blocking the calling thread when immediate confirmation is not required,
further enhancing runtime performance.












































































### Chunk Operations & Bytecode Logic

Chunk-level operations have also been a focus of this update. Methods such as `Chunk#getEntities()`,
`Chunk#load(boolean)`, and `Chunk#unload(boolean)` are now fully supported for redirection.
Chunk data in Folia is strictly owned by the region thread that manages the corresponding
world coordinates. Accessing entities within a chunk or triggering chunk loading/unloading
from an arbitrary thread is a high-risk operation that can lead to data corruption or
deadlocks if not properly synchronized.

The new `_ce`, `_cl`, and `_cu` wrappers in FoliaPatcher handle these operations by
interfacing with Folia's RegionScheduler. They correctly identify the target chunk's
coordinates and world to ensure the task is executed on the correct thread.
For `getEntities()`, we maintain the return type of `Entity[]`, ensuring binary compatibility
with legacy code. Loading and unloading operations are performed with support for
the 'generate' and 'save' flags, respectively, matching the standard Bukkit API contract.

To support these new redirections, the ScanningClassVisitor has been updated to
identify `org/bukkit/Chunk` as an 'interesting' owner. This allows our fast-scan
pre-patching phase to accurately flag classes that interact with chunks,
ensuring they are prioritized for full bytecode transformation while still
skipping unrelated classes to minimize patching time. The addition of Chunk-level
thread safety significantly broadens the types of plugins that can be successfully
migrated to Folia using Folia Phantom.












































































### Performance Optimization & Style Adherence

Performance is a core pillar of Project Argo. Following the directive to optimize for
maximum execution speed and AI-readable density, we have refactored the FoliaPatcher
runtime to use extremely short, obfuscated method names. This approach reduces
the constant pool size in transformed classes and minimizes the overhead of
method lookups and class loading.

The renaming scheme (e.g., `_ap` for safeAddPassenger, `_ce` for safeGetChunkEntities)
aligns with the existing 'short-name' architecture already present in the project
(such as `_o` for online players and `_b` for blocking calls).
This density is particularly beneficial in high-frequency call sites, where
every byte saved in the bytecode contributes to better cache locality and
reduced memory pressure during transformation and execution.

In addition to naming optimizations, we have strictly adhered to 2-space indentation
across all modified core files, in alignment with the Google Java Style Guide
requirements while maintaining a compact structure. The code is designed to be
easily parsed by AI agents, prioritizing logic flow and performance over
verbose human-centric documentation. We have also refined the internal logic
of the safe wrappers to minimize object allocation, particularly by avoiding
lambda creation when the current thread is already the primary thread.
This 'fast-path' check ensures that plugins running on the main thread
experience zero overhead when calling transformed methods.











































































### Verification, Build & Compatibility

Validation and verification have been performed using a comprehensive test suite
within the `test-plugin` module. We have added a new `testmore` command that
exercises all the newly implemented transformations. This include:
1. Validating that Entity passenger methods (`addPassenger`, `removePassenger`, `eject`)
   are correctly redirected to FoliaPatcher.
2. Confirming that Potion Effect modifications are scheduled on the entity's thread.
3. Verifying that Chunk entity queries and load/unload calls are handled via the Region Scheduler.
4. Ensuring that spatial queries using `getNearbyEntities` return accurate results
   even when called from asynchronous contexts.

The build process has been standardized to use Maven, and all resulting JAR artifacts
are placed in the `/argo/` directory at the project root for easy deployment.
This includes the Folia Phantom CLI, the GUI tool, the server-side Plugin,
and the verification Test Plugin. The CLI tool has been used to verify that
the transformations are applied correctly by inspecting the resulting bytecode
of the patched test plugin.

This update ensures that Folia Phantom remains the most advanced and performant
tool for Bukkit-to-Folia compatibility, providing a robust bridge for legacy plugins
while embracing an AI-first development philosophy. The combination of
expanded API coverage, extreme performance optimizations, and strict style
adherence makes this a critical milestone for Project Argo.











































































